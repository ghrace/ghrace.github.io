<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue公共函数 | 个人网站</title>
    <meta name="description" content="郭洪荣的前端学习记录 不仅仅是前端">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.f1f87914.css" as="style"><link rel="preload" href="/assets/js/app.4e2ee3c1.js" as="script"><link rel="preload" href="/assets/js/28.787b29f0.js" as="script"><link rel="prefetch" href="/assets/js/10.cee0cf73.js"><link rel="prefetch" href="/assets/js/11.60f8e3f6.js"><link rel="prefetch" href="/assets/js/12.5bc4d8b6.js"><link rel="prefetch" href="/assets/js/13.92e0fbae.js"><link rel="prefetch" href="/assets/js/14.2fe0fb7c.js"><link rel="prefetch" href="/assets/js/15.fb1e8867.js"><link rel="prefetch" href="/assets/js/16.9b5eb18e.js"><link rel="prefetch" href="/assets/js/17.5d6ab6ac.js"><link rel="prefetch" href="/assets/js/18.3941cf85.js"><link rel="prefetch" href="/assets/js/19.3fe2f218.js"><link rel="prefetch" href="/assets/js/2.821139ef.js"><link rel="prefetch" href="/assets/js/20.0db546c9.js"><link rel="prefetch" href="/assets/js/21.69751506.js"><link rel="prefetch" href="/assets/js/22.bd62d0ed.js"><link rel="prefetch" href="/assets/js/23.accaf272.js"><link rel="prefetch" href="/assets/js/24.738d7dd4.js"><link rel="prefetch" href="/assets/js/25.ccfe9700.js"><link rel="prefetch" href="/assets/js/26.ec2c5a12.js"><link rel="prefetch" href="/assets/js/27.3d48dbd5.js"><link rel="prefetch" href="/assets/js/29.f91c0906.js"><link rel="prefetch" href="/assets/js/3.394d1321.js"><link rel="prefetch" href="/assets/js/30.b60c3796.js"><link rel="prefetch" href="/assets/js/31.211c5c83.js"><link rel="prefetch" href="/assets/js/32.5591f0d9.js"><link rel="prefetch" href="/assets/js/33.5d00309c.js"><link rel="prefetch" href="/assets/js/34.c6bf1eb9.js"><link rel="prefetch" href="/assets/js/35.3f04e1ac.js"><link rel="prefetch" href="/assets/js/36.ab2f598d.js"><link rel="prefetch" href="/assets/js/37.c8b865da.js"><link rel="prefetch" href="/assets/js/38.b1187f83.js"><link rel="prefetch" href="/assets/js/39.0c8e0133.js"><link rel="prefetch" href="/assets/js/4.80c46bcd.js"><link rel="prefetch" href="/assets/js/40.02749473.js"><link rel="prefetch" href="/assets/js/41.aef6fc9b.js"><link rel="prefetch" href="/assets/js/42.8d02c078.js"><link rel="prefetch" href="/assets/js/5.1d391ffb.js"><link rel="prefetch" href="/assets/js/6.6b572077.js"><link rel="prefetch" href="/assets/js/7.2a379a6a.js"><link rel="prefetch" href="/assets/js/8.384fb931.js"><link rel="prefetch" href="/assets/js/9.b01601e0.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f1f87914.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">个人网站</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div><div class="nav-item"><a href="https://github.com/ghrace" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><a href="/about.html" class="nav-link">关于</a></div><div class="nav-item"><a href="https://github.com/ghrace" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading"><span>JS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>ES6</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>TypeScript</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading open"><span>Vue</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/posts/2018-08-13-vue-cli.html" class="sidebar-link">cli3简介</a></li><li><a href="/posts/2018-08-09-vue-iview.html" class="sidebar-link">iview tags</a></li><li><a href="/posts/2018-09-17-vue-learn.html" class="active sidebar-link">vue公共函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/posts/2018-09-17-vue-learn.html#vue公共函数" class="sidebar-link">vue公共函数</a></li><li class="sidebar-sub-header"><a href="/posts/2018-09-17-vue-learn.html#vue生命周期" class="sidebar-link">vue生命周期</a></li></ul></li><li><a href="/posts/2018-09-27-vue-code1.html" class="sidebar-link">了解vue</a></li><li><a href="/posts/2018-09-29-vue-code2.html" class="sidebar-link">从一个例子开始</a></li><li><a href="/posts/2018-09-30-vue-code3.html" class="sidebar-link">vue的初始化</a></li><li><a href="/posts/2018-10-08-vue-code4.html" class="sidebar-link">observe 工厂函数</a></li><li><a href="/posts/2018-10-09-vue-code5.html" class="sidebar-link">渲染函数的观察者</a></li><li><a href="/posts/2018-10-11-vue-code6.html" class="sidebar-link">计算属性的实现</a></li><li><a href="/posts/2018-10-12-vue-code7.html" class="sidebar-link">其他选项的初始化及实现</a></li><li><a href="/posts/2018-10-16-vue-code8.html" class="sidebar-link">Vue 编译器compiler</a></li></ul></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Python</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></div></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>Others</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><p>vue源码有很多值得学习的地方,编码规范风格,思想等等,先学习下vue的一些公共的函数</p> <h2 id="vue公共函数"><a href="#vue公共函数" aria-hidden="true" class="header-anchor">#</a> vue公共函数</h2> <p>打开vue.common.js,定义了一些后续会用到的函数,在源码的<code>shared/util.js</code>里</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//空对象,用object.freeze冻结一个对象，冻结指的是不能向这个对象添加新的属性，</span>
<span class="token comment">//不能修改其已有属性的值，不能删除已有属性，以及不能修改该对象已有属性的可枚举性、可配置性、可写性。该方法返回被冻结的对象。</span>
<span class="token keyword">let</span> emptyObject <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">freeze</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//判断是否为undefined 或者null</span>
<span class="token keyword">function</span> <span class="token function">isUndef</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> v <span class="token operator">===</span> undefined <span class="token operator">||</span> v <span class="token operator">===</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>
<span class="token comment">//相反</span>
<span class="token keyword">function</span> <span class="token function">isDef</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> v <span class="token operator">!==</span> undefined <span class="token operator">&amp;&amp;</span> v <span class="token operator">!==</span> <span class="token keyword">null</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * Check if value is primitive
 * 值是否为原始类型
 */</span>
<span class="token keyword">function</span> <span class="token function">isPrimitive</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">||</span>
    <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'number'</span> <span class="token operator">||</span>
    <span class="token comment">// $flow-disable-line</span>
    <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'symbol'</span> <span class="token operator">||</span>
    <span class="token keyword">typeof</span> value <span class="token operator">===</span> <span class="token string">'boolean'</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 是否是对象</span>
<span class="token keyword">function</span> <span class="token function">isObject</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> obj <span class="token operator">!==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">'object'</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> _toString <span class="token operator">=</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>toString<span class="token punctuation">;</span>

<span class="token comment">//获取值的原始类型 </span>
<span class="token comment">// 例如 &quot;[object String]&quot; 经过slice(8,-1)获取到的是String</span>
<span class="token keyword">function</span> <span class="token function">toRawType</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * Strict object type check. Only returns true
 * for plain JavaScript objects.
 * 简单对象（plain object），也就是用 {} 或 new Object() 创建的对象。
 */</span>
<span class="token keyword">function</span> <span class="token function">isPlainObject</span> <span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object Object]'</span>
<span class="token punctuation">}</span>
<span class="token comment">//是否是正则</span>
<span class="token keyword">function</span> <span class="token function">isRegExp</span> <span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> _toString<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'[object RegExp]'</span>
<span class="token punctuation">}</span>
<span class="token comment">/**
 * Check if val is a valid array index.
 * 是否是合法的数组索引
 */</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">isValidArrayIndex</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token comment">//isFinite用来检查一个数值是否为有限的（finite），即不是Infinity。</span>
 <span class="token comment">//Math.floor(2.2)===2.2 false</span>
 <span class="token comment">//Math.floor(2=== 2) true 判断为整数</span>
 <span class="token keyword">return</span> n <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">===</span> n <span class="token operator">&amp;&amp;</span> <span class="token function">isFinite</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">/** JSON.stringify(value[, replacer [, space]])
   *后面参数还没用过... 
   * replacer 可选
   如果该参数是一个函数，则在序列化过程中，被序列化的值的每个属性都会经过该函数的转换和处理；
   如果该参数是一个数组，则只有包含在这个数组中的属性名才会被序列化到最终的 JSON 字符串中；
   如果该参数为null或者未提供，则对象所有的属性都会被序列化；
   * space 可选
   指定缩进用的空白字符串，用于美化输出（pretty-print）；
   如果参数是个数字，它代表有多少的空格；上限为10。该值若小于1，则意味着没有空格；
   如果该参数为字符串(字符串的前十个字母)，该字符串将被作为空格；
   如果该参数没有提供（或者为null）将没有空格。

   另外 vue 这种三元运算符的写法结构比较清晰,值得学习
   */</span>
<span class="token keyword">function</span> <span class="token function">toString</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">return</span> val <span class="token operator">==</span> <span class="token keyword">null</span>
   <span class="token operator">?</span> <span class="token string">''</span>
   <span class="token punctuation">:</span> <span class="token keyword">typeof</span> val <span class="token operator">===</span> <span class="token string">'object'</span>
     <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
     <span class="token punctuation">:</span> <span class="token function">String</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">//转为数字</span>
<span class="token keyword">function</span> <span class="token function">toNumber</span> <span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">let</span> n <span class="token operator">=</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token keyword">return</span> <span class="token function">isNaN</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">?</span> val <span class="token punctuation">:</span> n
<span class="token punctuation">}</span>

<span class="token comment">/**
* Remove an item from an array
* 删除数字元素
*/</span>
<span class="token keyword">function</span> <span class="token function">remove</span> <span class="token punctuation">(</span>arr<span class="token punctuation">,</span> item<span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
   <span class="token keyword">let</span> index <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
   <span class="token keyword">if</span> <span class="token punctuation">(</span>index <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
     <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * Check whether the object has the property.
 * 指示对象自身属性中是否具有指定的属性,所有继承了 Object 的对象都会继承到 hasOwnProperty 方法。
  这个方法可以用来检测一个对象是否含有特定的自身属性；和 in 运算符不同，该方法会忽略掉那些从原型链上继承到的属性。
 */</span>
<span class="token keyword">let</span> hasOwnProperty <span class="token operator">=</span> Object<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>hasOwnProperty<span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">hasOwn</span> <span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> hasOwnProperty<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">makeMap</span> <span class="token punctuation">(</span>
  str<span class="token punctuation">:</span> string<span class="token punctuation">,</span>
  expectsLowerCase<span class="token operator">?</span><span class="token punctuation">:</span> boolean<span class="token comment">//是否大小写</span>
<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token punctuation">(</span>key<span class="token punctuation">:</span> string<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token boolean">true</span> <span class="token operator">|</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
  <span class="token comment">//定义一个对象 map</span>
  <span class="token keyword">const</span> map <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token comment">//根据逗号，将 str 分隔成数组并保存到 list 变量</span>
  <span class="token keyword">const</span> list<span class="token punctuation">:</span> Array<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span>
  <span class="token comment">// 遍历 list 并以 list 中的元素作为 map 的 key，将其设置为 true</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> list<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    map<span class="token punctuation">[</span>list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//返回一个函数，并且如果 expectsLowerCase 为 true 的话，将 map 的 key 小写</span>
  <span class="token keyword">return</span> expectsLowerCase
    <span class="token operator">?</span> val <span class="token operator">=&gt;</span> map<span class="token punctuation">[</span>val<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">:</span> val <span class="token operator">=&gt;</span> map<span class="token punctuation">[</span>val<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token comment">//为一个纯函数创建一个缓存版本的函数 是一个函数式编程的玩法</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> cached<span class="token operator">&lt;</span><span class="token constant">F</span><span class="token punctuation">:</span> Function<span class="token operator">&gt;</span> <span class="token punctuation">(</span>fn<span class="token punctuation">:</span> <span class="token constant">F</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token constant">F</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cache <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">cachedFn</span> <span class="token punctuation">(</span>str<span class="token punctuation">:</span> string<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//这个函数与原函数 fn 的区别就在于：先读取缓存</span>
    <span class="token keyword">const</span> hit <span class="token operator">=</span> cache<span class="token punctuation">[</span>str<span class="token punctuation">]</span>
    <span class="token comment">//命中则直接返回缓存的值，否则采用原函数 fn 计算一次并且设置缓存，然后返回结果</span>
    <span class="token keyword">return</span> hit <span class="token operator">||</span> <span class="token punctuation">(</span>cache<span class="token punctuation">[</span>str<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">fn</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">:</span> any<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">//全局匹配字符串中 中横线及连字符后的一个字符</span>
<span class="token keyword">const</span> camelizeRE <span class="token operator">=</span> <span class="token regex">/-(\w)/g</span>
<span class="token comment">//连字符转驼峰</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> camelize <span class="token operator">=</span> <span class="token function">cached</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//连字符后有字符，则将匹配到的内容使用该字符的大写形式替换，否则使用空字符串替换即可</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>camelizeRE<span class="token punctuation">,</span> <span class="token punctuation">(</span>_<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> c <span class="token operator">?</span> c<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//全局匹配字符串中的大写字母,大写字母前必须不是单词的边界</span>
<span class="token keyword">const</span> hyphenateRE <span class="token operator">=</span> <span class="token regex">/\B([A-Z])/g</span>
<span class="token comment">//驼峰转连字符</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> hyphenate <span class="token operator">=</span> <span class="token function">cached</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//匹配的内容使用连字符和捕获组的字符替换，最后转为小写</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>hyphenateRE<span class="token punctuation">,</span> <span class="token string">'-$1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//首字母大写</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> capitalize <span class="token operator">=</span> <span class="token function">cached</span><span class="token punctuation">(</span><span class="token punctuation">(</span>str<span class="token punctuation">:</span> string<span class="token punctuation">)</span><span class="token punctuation">:</span> string <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">/**
 * Convert an Array-like object to a real Array.类似数组转为真数组
 */</span>
<span class="token keyword">function</span> <span class="token function">toArray</span> <span class="token punctuation">(</span>list<span class="token punctuation">,</span> start<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  start <span class="token operator">=</span> start <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> i <span class="token operator">=</span> list<span class="token punctuation">.</span>length <span class="token operator">-</span> start<span class="token punctuation">;</span>
  <span class="token keyword">let</span> ret <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span>i<span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    ret<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> list<span class="token punctuation">[</span>i <span class="token operator">+</span> start<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ret
<span class="token punctuation">}</span>
<span class="token comment">/**
 * Mix properties into target object. -from对象 赋给to对象
 */</span>
<span class="token keyword">function</span> <span class="token function">extend</span> <span class="token punctuation">(</span>to<span class="token punctuation">,</span> _from<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> _from<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    to<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> _from<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> to
<span class="token punctuation">}</span>
<span class="token comment">//将一个对象数组合并到一个对象中，并返回该对象</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">toObject</span> <span class="token punctuation">(</span>arr<span class="token punctuation">:</span> Array<span class="token operator">&lt;</span>any<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> Object <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//如果 arr[i] 存在，则调用 extend 函数合并对象属性</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">extend</span><span class="token punctuation">(</span>res<span class="token punctuation">,</span> arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res
<span class="token punctuation">}</span>
<span class="token comment">/**
 * Always return false. 永远为false
 */</span>
<span class="token keyword">let</span> <span class="token function-variable function">no</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Return same value 返回原值
 */</span>
<span class="token keyword">let</span> <span class="token function-variable function">identity</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>_<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> _<span class="token punctuation">;</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// can we use __proto__? 还可以使用 Object.getPrototypeOf()</span>
<span class="token keyword">const</span> hasProto <span class="token operator">=</span> <span class="token string">'__proto__'</span> <span class="token keyword">in</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Browser environment sniffing 浏览器环检测</span>
<span class="token keyword">const</span> inBrowser <span class="token operator">=</span> <span class="token keyword">typeof</span> window <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> inWeex <span class="token operator">=</span> <span class="token keyword">typeof</span> WXEnvironment <span class="token operator">!==</span> <span class="token string">'undefined'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token operator">!</span>WXEnvironment<span class="token punctuation">.</span>platform<span class="token punctuation">;</span>
<span class="token keyword">const</span> weexPlatform <span class="token operator">=</span> inWeex <span class="token operator">&amp;&amp;</span> WXEnvironment<span class="token punctuation">.</span>platform<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">UA</span> <span class="token operator">=</span> inBrowser <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isIE <span class="token operator">=</span> <span class="token constant">UA</span> <span class="token operator">&amp;&amp;</span> <span class="token regex">/msie|trident/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token constant">UA</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isIE9 <span class="token operator">=</span> <span class="token constant">UA</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">UA</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'msie 9.0'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isEdge <span class="token operator">=</span> <span class="token constant">UA</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">UA</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'edge/'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isAndroid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">UA</span> <span class="token operator">&amp;&amp;</span> <span class="token constant">UA</span><span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'android'</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>weexPlatform <span class="token operator">===</span> <span class="token string">'android'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isIOS <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token constant">UA</span> <span class="token operator">&amp;&amp;</span> <span class="token regex">/iphone|ipad|ipod|ios/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token constant">UA</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>weexPlatform <span class="token operator">===</span> <span class="token string">'ios'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> isChrome <span class="token operator">=</span> <span class="token constant">UA</span> <span class="token operator">&amp;&amp;</span> <span class="token regex">/chrome\/\d+/</span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token constant">UA</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>isEdge<span class="token punctuation">;</span>

<span class="token comment">// Firefox has a &quot;watch&quot; function on Object.prototype... </span>
<span class="token comment">//火狐浏览器有个watch,做相关处理避免和vue的watch 冲突</span>
<span class="token keyword">const</span> nativeWatch <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>watch<span class="token punctuation">;</span>
<span class="token comment">/**
 * Define a property.
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">def</span> <span class="token punctuation">(</span>obj<span class="token punctuation">:</span> Object<span class="token punctuation">,</span> key<span class="token punctuation">:</span> string<span class="token punctuation">,</span> val<span class="token punctuation">:</span> any<span class="token punctuation">,</span> enumerable<span class="token operator">?</span><span class="token punctuation">:</span> boolean<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> key<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> val<span class="token punctuation">,</span>
    enumerable<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token operator">!</span>enumerable<span class="token punctuation">,</span><span class="token comment">//如果不传递 enumerable 参数则代表定义的属性是不可枚举的 !!undefined ==false</span>
    writable<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> 
    configurable<span class="token punctuation">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="vue生命周期"><a href="#vue生命周期" aria-hidden="true" class="header-anchor">#</a> vue生命周期</h2> <ul><li>beforeCreate<br>
在实例初始化之后，数据观测(data observer) 和 event/watcher 事件配置之前被调用。</li> <li>created<br>
实例已经创建完成之后被调用。在这一步，实例已完成以下的配置：数据观测(data observer)，属性和方法的运算， watch/event 事件回调。然而，挂载阶段还没开始，$el 属性目前不可见。</li> <li>beforeMount<br>
在挂载开始之前被调用：相关的 render 函数首次被调用。</li> <li>mounted<br>
el 被新创建的 vm.$el 替换，并挂载到实例上去之后调用该钩子。如果 root 实例挂载了一个文档内元素，当 mounted 被调用时 vm.$el 也在文档内。</li> <li>beforeUpdate<br>
数据更新时调用，发生在虚拟 DOM 重新渲染和打补丁之前。 你可以在这个钩子中进一步地更改状态，这不会触发附加的重渲染过程。</li> <li>updated<br>
由于数据更改导致的虚拟 DOM 重新渲染和打补丁，在这之后会调用该钩子。
当这个钩子被调用时，组件 DOM 已经更新，所以你现在可以执行依赖于 DOM 的操作。然而在大多数情况下，你应该避免在此期间更改状态，因为这可能会导致更新无限循环。
该钩子在服务器端渲染期间不被调用。</li> <li>beforeDestroy<br>
实例销毁之前调用。在这一步，实例仍然完全可用。</li> <li>destroyed<br>
Vue 实例销毁后调用。调用后，Vue 实例指示的所有东西都会解绑定，所有的事件监听器会被移除，所有的子实例也会被销毁。 该钩子在服务器端渲染期间不被调用。</li></ul></div> <div class="page-edit"><!----> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/posts/2018-08-09-vue-iview.html" class="prev">
          iview tags
        </a></span> <span class="next"><a href="/posts/2018-09-27-vue-code1.html">
          了解vue
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.4e2ee3c1.js" defer></script><script src="/assets/js/28.787b29f0.js" defer></script>
  </body>
</html>
